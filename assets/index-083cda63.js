import{B as E,D as k,C as d,r as C,o as m,a as B,d as T,i as f,h as l,e as M,g as u,t as r,I as R,E as w,y as Y,c as F,w as N,A as P}from"./vue-libs-eb153a24.js";import{c as V,j as z,C as D,a as L}from"./helper-1e979f21.js";import{g as j}from"./index-7dbb04b3.js";import{_ as x}from"./locales-2658cfbc.js";const A=E({name:V("PullRefresh")[0],emits:["refresh","update:modelValue"],options:{virtualHost:!0},components:{FanLoading:z},props:{customStyle:[String,Object],pullingText:{type:String,default:"下拉即可刷新..."},loosingText:{type:String,default:"释放即可刷新..."},loadingText:{type:String,default:"加载中..."},successText:{type:String,default:"加载成功"}},setup(t,{emit:o}){const s=k({status:"success",top:0,height:50,start:0,startY:0,isTouch:!1}),a=d(()=>L(t.customStyle)),h=d(()=>{let e="";return s.status==="pulling"?e=t.pullingText:s.status==="loosing"?e=t.loosingText:s.status==="loading"?e=t.loadingText:e=t.successText,e}),g=e=>(e=e-s.start,e>s.height&&(e<s.height*2?e=s.height+(e-s.height)/2:e=s.height*1.5+(e-s.height*2)/4),Math.round(e)),c=w(),n=async()=>{const{y:e}=await j({selector:".fan-pull-refresh__head",scope:c});return e},y=async e=>{s.isTouch=!0;const i=await n();s.startY=i,s.start=e.touches[0].clientY},S=e=>{const i=g(e.touches[0].clientY);s.top=i>0?i:0,$()},p=()=>{s.status="success",s.top=0},v=()=>{s.isTouch=!1,s.top>=s.height?(s.status="loading",s.top=s.height,o("refresh",p)):s.top=0},$=()=>{Math.round(s.top-s.startY)>=s.height?s.status="loosing":s.status="pulling"};return{theStyle:a,state:s,statusTxt:h,onTouchStart:y,onTouchMove:S,onTouchEnd:v,stopPullRefresh:p,Config:D}}});function I(t,o,s,a,h,g){const c=C("FanLoading");return m(),B("div",{style:f([t.theStyle,{touchAction:t.state.isTouch?"none":"auto"}]),class:"fan-pull-refresh",onTouchstartPassive:o[0]||(o[0]=(...n)=>t.onTouchStart&&t.onTouchStart(...n)),onTouchmove:o[1]||(o[1]=R((...n)=>t.onTouchMove&&t.onTouchMove(...n),["prevent"])),onTouchend:o[2]||(o[2]=(...n)=>t.onTouchEnd&&t.onTouchEnd(...n)),onTouchcancel:o[3]||(o[3]=(...n)=>t.onTouchEnd&&t.onTouchEnd(...n))},[T("div",{class:"fan-pull-refresh__inner",style:f({transform:`translate3d(0, ${t.state.top}px, 0)`,transitionDuration:t.state.isTouch?"0ms":"300ms"})},[T("div",{class:"fan-pull-refresh__head fan-flex-center",style:f({height:`${t.state.height}px`})},[t.state.status==="loading"?l(t.$slots,"loading",{key:0},()=>[M(c,{size:"16","custom-style":"margin-right: 6px"}),u(" "+r(t.statusTxt),1)]):t.state.status==="pulling"?l(t.$slots,"pulling",{key:1},()=>[u(r(t.statusTxt),1)]):t.state.status==="loosing"?l(t.$slots,"loosing",{key:2},()=>[u(r(t.statusTxt),1)]):l(t.$slots,"success",{key:3},()=>[u(r(t.statusTxt),1)])],4),l(t.$slots,"default")],4)],36)}const b=x(A,[["render",I]]),G={__name:"index",setup(t){const o=Y(0),s=a=>{setTimeout(()=>{o.value++,a()},1e3)};return(a,h)=>(m(),F(P(b),{style:{height:"calc(100vh - 80px)"},onRefresh:s},{default:N(()=>[u(" 刷新次数："+r(o.value),1)]),_:1}))}};export{G as default};
